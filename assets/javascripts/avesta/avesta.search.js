Avesta.Search={initialize:function(){var e=this;$(".refine-search").find("input,select").on("change",function(t){e._filter($(this.form).serializeObject())})},prepareForm:function(){$("select[name=city]").append(Avesta._render("city-options",{cities:Avesta.cities}))},_filter:function(e){var t=_.filter(Avesta.data,function(t){var n=!0,r=!0,i=!0,s=!0;e.beds&&(n=_.contains(t.numBeds,e.beds)),e.baths&&(r=_.contains(t.numBaths,e.baths)),e.city&&(s=t.city==e.city);if(e.rent){var o=_.map(e.rent.split("-"),function(e){return parseInt(e)}),u=parseInt(t.minRent[0]);maxRent=parseInt(t.maxRent[t.maxRent.length-1]),i=u>=o[0]&&u<=o[1]||maxRent>=o[0]&&maxRent<=o[1]}return n&&r&&i&&s});Avesta.renderResults(t),Avesta.Map.addMarkers(t)},_parseQueryParams:function(){return _.map(window.location.search.split("&"),function(e){var t=e.match(/city=(.*)/);if(t)return t[1].replace("+"," ")})}};